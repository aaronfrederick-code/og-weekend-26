<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OG Weekend 2026</title>
    <!-- We're using Tailwind CSS for styling, loaded from a CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- We're using Lucide for icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Configuration for Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            DEFAULT: '#0284c7', // Brighter blue
                            dark: '#0369a1',
                        },
                        // ✨ New Color Themes
                        'primary-red': {
                            DEFAULT: '#dc2626',
                            dark: '#b91c1c',
                            light: '#fee2e2'
                        },
                        'primary-green': {
                            DEFAULT: '#16a34a',
                            dark: '#15803d',
                            light: '#dcfce7'
                        },
                        'primary-gold': {
                            DEFAULT: '#d97706',
                            dark: '#b45309',
                            light: '#fef3c7'
                        },
                        'primary-navy': {
                            DEFAULT: '#172554',
                            dark: '#1e3a8a',
                            light: '#dbeafe'
                        },
                        slate: { // Using slate for a cooler gray palette
                           50: '#f8fafc',
                           100: '#f1f5f9',
                           200: '#e2e8f0',
                           300: '#cbd5e1',
                           400: '#94a3b8',
                           500: '#64748b',
                           600: '#475569',
                           700: '#334152',
                           800: '#1e293b',
                           900: '#0f172a',
                        },
                        light: '#f4f4f4',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Simple icon replacement class for lucide */
        .icon {
            display: inline-block;
            width: 1.25em;
            height: 1.25em;
            stroke-width: 2;
            vertical-align: middle;
        }

        /* --- ✨ New Fullscreen Background --- */
        body {
            /* Set the background image */
            background-image: url('https://images.unsplash.com/photo-1535131749006-b7f58c99034b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center center;
            background-attachment: fixed; /* Keeps the background static while scrolling */
            background-repeat: no-repeat;
        }

        /* --- Itinerary Timeline --- */
        .itinerary-day {
            position: relative;
            /* Make room for the timeline dots and line */
            padding-left: 2.5rem; 
        }

        /* The 'dot' for each day's stop */
        .itinerary-day::before {
            content: '';
            position: absolute;
            left: 0;
            /* Aligns with the top of the h4 heading */
            top: 0.35rem; 
            width: 1.25rem;
            height: 1.25rem;
            background-color: #fff;
            /* Use the --tab-color variable, default to green */
            border: 4px solid var(--tab-color, #16a34a); 
            border-radius: 50%;
            z-index: 10;
        }

        /* The dotted line connecting the days */
        .itinerary-day::after {
            content: '';
            position: absolute;
            /* Centered with the dot */
            left: 0.525rem; 
            /* Start below the dot */
            top: 1.6rem; 
            /* Extend down past the bottom padding */
            bottom: -1.5rem; 
            width: 3px;
            /* Create a dashed line using a gradient */
            background-image: linear-gradient(to bottom, var(--tab-color, #16a34a) 60%, transparent 40%);
            background-size: 100% 10px; /* 10px dash/gap */
            background-repeat: repeat-y;
            opacity: 0.4;
            z-index: 5;
        }

        /* Hide the connecting line on the last day */
        .itinerary-day:last-child::after {
            display: none;
        }

        /* --- Gemini Modal & Loader --- */
        .gemini-modal {
            transition: opacity 0.25s ease;
        }
        .gemini-modal-content {
            transition: transform 0.25s ease;
        }
        /* Simple spinning loader */
        .loader {
            border: 4px solid #f3f3f3;
            /* Use CSS variable for loader color, default to blue */
            border-top: 4px solid var(--tab-color, #0284c7);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- ✨ Tab System --- */
        .tab-panel {
            /* All panels are hidden by default */
            display: none;
        }
        .tab-panel.active {
            /* Active panel is shown */
            display: block;
        }

        /* Styling for the active tab button */
        .tab-button.active-tab-blue {
            background-color: #0284c7;
            color: white;
            border-color: #0284c7;
        }
        .tab-button.active-tab-red {
            background-color: #dc2626;
            color: white;
            border-color: #dc2626;
        }
        .tab-button.active-tab-green {
            background-color: #16a34a;
            color: white;
            border-color: #16a34a;
        }
        .tab-button.active-tab-gold {
            background-color: #d97706;
            color: white;
            border-color: #d97706;
        }
         .tab-button.active-tab-navy {
            background-color: #172554;
            color: white;
            border-color: #172554;
        }

        /* --- ✨ New AI Concierge Chat Styles --- */
        .chat-bubble {
            max-width: 80%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            word-wrap: break-word;
        }
        .chat-bubble-user {
            background-color: #dbeafe; /* light blue */
            color: #1e3a8a; /* dark blue */
            border-bottom-right-radius: 0.25rem; /* Creates the 'tail' */
            align-self: flex-end;
        }
        .chat-bubble-ai {
            background-color: #f1f5f9; /* light slate */
            color: #334152; /* dark slate */
            border-bottom-left-radius: 0.25rem; /* Creates the 'tail' */
            align-self: flex-start;
        }
        .chat-bubble-error {
            background-color: #fee2e2; /* light red */
            color: #b91c1c; /* dark red */
            border-bottom-left-radius: 0.25rem;
            align-self: flex-start;
        }
        .chat-sources {
            font-size: 0.875rem;
            color: #475569;
            padding-left: 1rem;
            border-left: 2px solid #cbd5e1;
        }

    </style>
</head>
<!-- Removed bg-slate-50 --><body class="text-slate-700">

    <!-- Header Section - Removed bg image and overlay, now just a container for text --><header class="relative flex items-center justify-center h-64">
        <!-- Transparent overlay for text readability -->
        <div class="absolute inset-0 bg-black/30"></div> 
        
        <div class="relative z-10 text-center p-8">
             <h1 class="text-4xl md:text-5xl font-bold mb-2 text-white" style="text-shadow: 1px 1px 4px rgba(0,0,0,0.5);">OG Weekend 2026</h1>
            <p class="text-xl md:text-2xl text-white/90" style="text-shadow: 1px 1px 4px rgba(0,0,0,0.5);">February 5th - February 8th, 2026</p>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-4xl mx-auto p-4 md:p-8">

        <!-- ✨ New Tab Navigation -->
        <!-- Updated to 5 columns for 'Gallery' -->
        <nav class="grid grid-cols-3 md:grid-cols-5 gap-2 mb-8 bg-white/70 backdrop-blur-sm p-2 rounded-xl shadow-lg">
            <button data-tab="booking" data-theme="blue" class="tab-button active-tab-blue font-semibold text-slate-700 p-3 rounded-lg border border-transparent transition-all duration-300 ease-in-out">
                Booking Info
            </button>
            <button data-tab="tools" data-theme="red" class="tab-button font-semibold text-slate-700 p-3 rounded-lg border border-transparent transition-all duration-300 ease-in-out hover:bg-slate-200">
                Trip Tools
            </button>
            <button data-tab="itinerary" data-theme="green" class="tab-button font-semibold text-slate-700 p-3 rounded-lg border border-transparent transition-all duration-300 ease-in-out hover:bg-slate-200">
                Itinerary
            </button>
            <button data-tab="abba" data-theme="gold" class="tab-button font-semibold text-slate-700 p-3 rounded-lg border border-transparent transition-all duration-300 ease-in-out hover:bg-slate-200">
                ABBA
            </button>
            <button data-tab="gallery" data-theme="navy" class="tab-button font-semibold text-slate-700 p-3 rounded-lg border border-transparent transition-all duration-300 ease-in-out hover:bg-slate-200">
                Gallery
            </button>
        </nav>


        <!-- ✨ Tab Content Panels -->
        <div>
            <!-- ✨ Booking Card (Blue Theme) -->
            <section id="booking" class="tab-panel active bg-white/90 backdrop-blur-sm rounded-xl shadow-lg mb-12 overflow-hidden transition-all duration-300 hover:shadow-xl">
                <div class="p-6 md:p-8">
                    <!-- Consistent Header Color -->
                    <h2 class="text-3xl font-semibold mb-6 pb-4 border-b border-slate-200 text-slate-900">
                        Booking Information
                    </h2>
                    
                    <!-- Lodging -->
                    <div class="mb-6">
                        <h3 class="text-2xl font-semibold mb-3 flex items-center">
                            <i data-lucide="home" class="icon mr-3 text-primary"></i>
                            Lodging
                        </h3>
                        <p class="text-lg text-slate-700 mb-4"><strong>Airbnb in Montgomery</strong></p>
                        <a href="https://www.airbnb.com/rooms/626832094255090711" target="_blank" class="inline-flex items-center bg-primary text-white font-semibold py-3 px-5 rounded-lg shadow-md hover:bg-primary-dark transition-all duration-300 ease-in-out">
                            <i data-lucide="link-2" class="icon mr-2"></i>
                            View Airbnb Listing
                        </a>
                    </div>

                    <!-- Flights -->
                    <div class="mb-6">
                        <h3 class="text-2xl font-semibold mb-3 flex items-center">
                            <i data-lucide="plane" class="icon mr-3 text-primary"></i>
                            Flights
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <p class="text-lg text-slate-700 font-semibold">Arrival (2/5):</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Flight:</strong> AA 5017</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Departs DFW:</strong> 11:00 AM</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Arrives MGM:</strong> 12:55 PM</p>
                            </div>
                            <div>
                                <p class="text-lg text-slate-700 font-semibold">Departure (2/8):</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Flight:</strong> AA 5077</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Departs MGM:</strong> 1:25 PM</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Arrives DFW:</strong> 3:50 PM</p>
                            </div>
                        </div>
                        <div class="mt-6">
                            <a href="https://www.google.com/travel/flights/booking?tfs=CBwQAhpFEgoyMDI2LTAyLTA1IiAKA0RGVxIKMjAyNi0wMi0wNRoDTUdNKgJBQTIENTAxN2oMCAISCC9tLzBmMnJxcgcIARIDTUdNGkUSCjIwMjYtMDItMDgiIAoDTUdNEgoyMDI2LTAyLTA4GgNERlcqAkFBMgQ1MDc3agcIARIDTUdNcgwIAhIIL20vMGYycnFAAUgBcAGCAQsI____________AZgBAQ&tfu=CmxDalJJU1hBeWJWTTFWWEIwVXpoQlFXWmhibEZDUnkwdExTMHRMUzB0TFc5NVkyMDBNa0ZCUVVGQlIybzFWVkZKVGt4SVYyTkJFZ1pCUVRVd056Y2FDd2l4MEFJUUFob0RWVk5FT0J4d3NkQUMSBggAIAEoAiIGCgEwCgEx&hl=en&gl=US&curr=USD" target="_blank" class="inline-flex items-center bg-primary text-white font-semibold py-3 px-5 rounded-lg shadow-md hover:bg-primary-dark transition-all duration-300 ease-in-out">
                                <i data-lucide="link-2" class="icon mr-2"></i>
                                View Google Flights Booking
                            </a>
                        </div>
                    </div>

                    <!-- Car Rental -->
                    <div>
                        <h3 class="text-2xl font-semibold mb-3 flex items-center">
                            <i data-lucide="car" class="icon mr-3 text-primary"></i>
                            Car Rental
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <p class="text-lg text-slate-700 font-semibold">Vehicle:</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Enterprise:</strong> 7-Passenger Mini-Van</p>
                                <p class="text-lg text-slate-700 pl-4">(Chrysler Pacifica or similar)</p>
                                <p class="text-lg text-slate-700 pl-4"><strong class="text-primary-dark">Confirmation:</strong> 1588667854</p>
                            </div>
                            <div>
                                <p class="text-lg text-slate-700 font-semibold">Pick-up (2/5):</p>
                                <p class="text-lg text-slate-700 pl-4">3:30 PM @ MGM Airport</p>
                                <p class="text-lg text-slate-700 font-semibold mt-2">Drop-off (2/8):</p>
                                <p class="text-lg text-slate-700 pl-4">11:00 AM @ MGM Airport</p>
                            </div>
                        </div>
                        <div class="mt-6">
                            <a href="https://mail.google.com/mail/u/1/#inbox/FMfcgzQcqQzRTCHKFPRTPgbVCWjtzxWT" target="_blank" class="inline-flex items-center bg-primary text-white font-semibold py-3 px-5 rounded-lg shadow-md hover:bg-primary-dark transition-all duration-300 ease-in-out">
                                <i data-lucide="mail" class="icon mr-2"></i>
                                View Confirmation Email
                            </a>
                        </div>
                    </div>

                </div>
            </section>

            <!-- ✨ Trip Tools Card (Red Theme) -->
            <section id="tools" class="tab-panel hidden bg-white/90 backdrop-blur-sm rounded-xl shadow-lg mb-12 overflow-hidden transition-all duration-300 hover:shadow-xl">
                <div class="p-6 md:p-8">
                    <!-- Consistent Header Color -->
                    <h2 class="text-3xl font-semibold mb-6 pb-4 border-b border-slate-200 text-slate-900">
                        Trip Tools
                    </h2>
                    
                    <div class="mb-6">
                        <h3 class="text-2xl font-semibold mb-3 flex items-center">
                            <i data-lucide="sparkles" class="icon mr-3 text-primary-red-DEFAULT"></i>
                            AI Packing List
                        </h3>
                        <p class="text-lg text-slate-700 mb-4">Not sure what to pack? Let AI generate a custom list for your trip.</p>
                        <!-- Updated Button Style -->
                        <button id="generate-packing-list" class="inline-flex items-center bg-primary-red-light text-primary-red-dark font-semibold py-3 px-5 rounded-lg shadow-md hover:bg-primary-red-DEFAULT hover:text-white transition-all duration-300 ease-in-out">
                            <i data-lucide="sparkles" class="icon mr-2"></i>
                            ✨ Generate Packing List
                        </button>
                    </div>
                </div>
            </section>

            <!-- ✨ Itinerary Card (Green Theme) -->
            <section id="itinerary" class="tab-panel hidden bg-white/90 backdrop-blur-sm rounded-xl shadow-lg mb-12 overflow-hidden transition-all duration-300 hover:shadow-xl">
                <!-- Add 'relative' class here to contain the timeline elements -->
                <div class="p-6 md:p-8 relative">
                    <!-- Consistent Header Color -->
                    <h2 class="text-3xl font-semibold mb-6 pb-4 border-b border-slate-200 text-slate-900">
                        Itinerary
                    </h2>
                    
                    <!-- Thursday -->
                    <div class="itinerary-day mb-6 pb-6 border-b border-slate-200">
                        <h4 class="text-2xl font-semibold mb-3 text-slate-900">Thursday, Feb 5</h4>
                        <ul class="list-disc list-inside text-lg text-slate-700 space-y-2">
                            <li>Arrive in Montgomery (MGM) @ 12:55 PM</li>
                            <li>Pick up groceries</li>
                            <li>Head to Airbnb and get settled</li>
                            <li>Go to dinner</li>
                            <!-- ✨ New Gemini Dinner Suggestion Button -->
                            <li class="list-none mt-3">
                                <!-- Updated Button Style -->
                                <button id="generate-dinner-ideas" class="inline-flex items-center bg-primary-green-light text-primary-green-dark font-semibold py-2 px-4 rounded-lg shadow-sm hover:bg-primary-green-DEFAULT hover:text-white transition-all duration-300 ease-in-out">
                                    <i data-lucide="sparkles" class="icon mr-2"></i>
                                    ✨ Suggest Dinner Spots
                                </button>
                            </li>
                            <li>Watch Mavericks vs. Spurs @ 7:30 PM -- Will Kyrie be back?!</li>
                        </ul>
                        
                        <!-- Thursday Images -->
                        <div class="mt-4 space-y-4">
                            <!-- Airbnb Images -->
                            <div class="grid grid-cols-2 gap-4">
                                <img src="https://a0.muscache.com/im/pictures/miso/Hosting-626832094255090711/original/81adfabb-b218-4c02-8afd-7b5a2d7e253a.jpeg?im_w=1440" 
                                     alt="View of the Airbnb" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">    
                                <img src="https://a0.muscache.com/im/pictures/371927eb-42d2-465b-8d41-9a1c92106612.jpg?im_w=1440" 
                                     alt="View of Airbnb2" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">
                            </div>
                            <!-- Mavs Images -->
                            <div class="grid grid-cols-2 gap-4">
                                <img src="https://images2.minutemediacdn.com/image/upload/c_crop,x_1170,y_0,w_4520,h_2542/c_fill,w_680,ar_16:9,f_auto,q_auto,g_auto/images/ImagnImages/mmsport/dallas_basketball/01k84q2r3jyreb94kfpg.jpg" 
                                     alt="View of the Dallas Mavs" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">    
                                <img src="https://www.vmcdn.ca/f/files/shared/feeds/cp/2024/03/20240317180328-65f76ef1f3c80c0a0c027409jpeg.jpg;w=1200;h=800;mode=crop" 
                                     alt="View of Kyrie Game Winner" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">
                            </div>
                        </div>
                    </div>

                    <!-- Friday -->
                    <div class="itinerary-day mb-6 pb-6 border-b border-slate-200">
                        <h4 class="text-2xl font-semibold mb-3 text-slate-900">Friday, Feb 6</h4>
                        <ul class="list-disc list-inside text-lg text-slate-700 space-y-2">
                            <li><strong>Morning:</strong> Head to Capitol Hill (Robert Trent Jones Golf)</li>
                            <li>Play 36 holes at Legislator (Tee times: 8:10 AM & 1:10 PM)</li>
                            <li><strong>Evening:</strong> Go back to the Airbnb, make dinner, and hang out</li>
                        </ul>
                        <!-- ✨ New Caddy Button for Friday -->
                        <div class="mt-4 flex flex-wrap gap-4">
                            <!-- Updated Button Style -->
                            <button id="caddy-legislator" class="inline-flex items-center bg-primary-green-light text-primary-green-dark font-semibold py-2 px-4 rounded-lg shadow-sm hover:bg-primary-green-DEFAULT hover:text-white transition-all duration-300 ease-in-out">
                                <i data-lucide="sparkles" class="icon mr-2"></i>
                                ✨ Legislator Caddy Tips
                            </button>
                            <!-- Updated Button Style -->
                            <button id="caddy-ask-legislator" class="inline-flex items-center bg-slate-200 text-slate-800 font-semibold py-2 px-4 rounded-lg shadow-sm hover:bg-slate-300 transition-all duration-300 ease-in-out">
                                <i data-lucide="help-circle" class="icon mr-2"></i>
                                Ask Legislator Caddy...
                            </button>
                        </div>
                        <!-- Friday Golf Images -->
                        <div class="grid grid-cols-2 gap-4 mt-4">
                            <a href="https://www.rtjgolf.com/capitolhill/" target="_blank" rel="noopener noreferrer">
                                <img src="https://www.rtjgolf.com/img/sm-ch-l.jpg" 
                                     alt="View of the Legislator Course" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">
                            </a>
                            <a href="https://www.rtjgolf.com/capitolhill/" target="_blank" rel="noopener noreferrer">
                                <img src="https://www.rtjgolf.com/img/sm-ch-l.jpg" 
                                     alt="View of the Legislator Course" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">
                            </a>
                        </div>
                    </div>

                    <!-- Saturday -->
                    <div class="itinerary-day mb-6 pb-6 border-b border-slate-200">
                        <h4 class="text-2xl font-semibold mb-3 text-slate-900">
                            Saturday, Feb 7 
                            <span class="text-lg font-normal text-slate-500 italic ml-2">-- Rinse and Repeat, baby</span>
                        </h4>
                        <ul class="list-disc list-inside text-lg text-slate-700 space-y-2">
                            <li><strong>Morning:</strong> Head to Capitol Hill (Robert Trent Jones Golf)</li>
                            <li>Play 36 holes at Senator (Tee times: 8:00 AM & 1:00 PM)</li>
                            <li><strong>Evening:</strong> Go back to the Airbnb, make dinner, and hang out</li>
                        </ul>
                        <!-- ✨ New Caddy Button for Saturday -->
                        <div class="mt-4 flex flex-wrap gap-4">
                            <!-- Updated Button Style -->
                            <button id="caddy-senator" class="inline-flex items-center bg-primary-green-light text-primary-green-dark font-semibold py-2 px-4 rounded-lg shadow-sm hover:bg-primary-green-DEFAULT hover:text-white transition-all duration-300 ease-in-out">
                                <i data-lucide="sparkles" class="icon mr-2"></i>
                                ✨ Senator Caddy Tips
                            </button>
                            <!-- Updated Button Style -->
                            <button id="caddy-ask-senator" class="inline-flex items-center bg-slate-200 text-slate-800 font-semibold py-2 px-4 rounded-lg shadow-sm hover:bg-slate-300 transition-all duration-300 ease-in-out">
                                <i data-lucide="help-circle" class="icon mr-2"></i>
                                Ask Senator Caddy...
                            </button>
                        </div>
                        <!-- Saturday Golf Images -->
                        <div class="grid grid-cols-2 gap-4 mt-4">
                            <a href="https://www.rtjgolf.com/capitolhill/" target="_blank" rel="noopener noreferrer">
                                <img src="https://www.rtjgolf.com/img/sm-ch-s.jpg" 
                                     alt="View of the Senator Course" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">
                            </a>
                            <a href="https://www.rtjgolf.com/capitolhill/" target="_blank" rel="noopener noreferrer">
                                <img src="https://www.rtjgolf.com/img/sm-ch-s.jpg" 
                                     alt="View of the Senator Course" 
                                     class="w-full h-auto rounded-xl shadow-md aspect-video object-cover transition-transform duration-300 ease-in-out hover:scale-105"
                                     onerror="this.src='https://placehold.co/600x400/eeeeee/999999?text=Replace+Image+URL'; this.onerror=null;">
                            </a>
                        </div>
                    </div>

                    <!-- Sunday -->
                    <div class="itinerary-day mb-6">
                        <h4 class="text-2xl font-semibold mb-3 text-slate-900">Sunday, Feb 8</h4>
                        <ul class="list-disc list-inside text-lg text-slate-700 space-y-2">
                            <li>Make breakfast at the Airbnb</li>
                            <li>Pack up and leave for the airport</li>
                            <li>Head home!</li>
                        </ul>
                    </div>

                </div>
            </section>
            
            <!-- ✨ New ABBA Card (Gold Theme) -->
            <section id="abba" class="tab-panel hidden bg-white/90 backdrop-blur-sm rounded-xl shadow-lg mb-12 overflow-hidden transition-all duration-300 hover:shadow-xl">
                <div class="p-6 md:p-8">
                    <!-- Consistent Header Color -->
                    <h2 class="text-3xl font-semibold mb-6 pb-4 border-b border-slate-200 text-slate-900">
                        ABBA
                    </h2>
                    
                    <!-- Chat Interface -->
                    <div class="flex flex-col space-y-4 h-[60vh]">
                        <!-- Chat Message Area -->
                        <div id="chat-messages" class="flex-grow flex flex-col space-y-4 p-4 bg-slate-100/70 rounded-lg overflow-y-auto">
                            <!-- Welcome Message -->
                            <div class="chat-bubble chat-bubble-ai">
                                Hello! I'm ABBA, your AI concierge for the OG Weekend. Think of me as your fifth OG... if you'll have me. How can I help you with your trip?
                            </div>
                            <!-- Messages will be injected here -->
                        </div>
                        
                        <!-- Chat Input Area -->
                        <div class="flex-shrink-0 flex space-x-2">
                            <input type="text" id="chat-input" class="flex-grow p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-gold-DEFAULT focus:outline-none" placeholder="Ask ABBA anything...">
                            <button id="chat-submit" class="inline-flex items-center justify-center bg-primary-gold-DEFAULT text-white font-semibold p-3 rounded-lg shadow-md hover:bg-primary-gold-dark transition-all duration-300 ease-in-out">
                                <i data-lucide="send" class="w-6 h-6"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ✨ New Gallery Card (Navy Theme) -->
            <section id="gallery" class="tab-panel hidden bg-white/90 backdrop-blur-sm rounded-xl shadow-lg mb-12 overflow-hidden transition-all duration-300 hover:shadow-xl">
                <div class="p-6 md:p-8">
                    <!-- Consistent Header Color -->
                    <h2 class="text-3xl font-semibold mb-6 pb-4 border-b border-slate-200 text-slate-900">
                        Gallery
                    </h2>
                    
                    <!-- Carousel & Thumbnails -->
                    <div class="space-y-4">
                        <!-- Placeholder for empty gallery -->
                        <div id="gallery-placeholder" class="hidden text-center text-slate-600 py-10">
                            Loading gallery...
                        </div>
                        
                        <!-- Main Carousel -->
                        <div id="carousel-container" class="relative w-full h-auto bg-slate-200/70 rounded-xl aspect-video overflow-hidden">
                            <img id="carousel-image" src="https://placehold.co/800x450/172554/white?text=Loading..." alt="Main gallery image" class="w-full h-full object-cover transition-opacity duration-300">
                            
                            <!-- Prev/Next Buttons -->
                            <button id="carousel-prev" class="absolute left-3 top-1/2 -translate-y-1/2 bg-white/50 text-slate-900 rounded-full p-2 hover:bg-white transition-all backdrop-blur-sm">
                                <i data-lucide="chevron-left" class="w-6 h-6"></i>
                            </button>
                            <button id="carousel-next" class="absolute right-3 top-1/2 -translate-y-1/2 bg-white/50 text-slate-900 rounded-full p-2 hover:bg-white transition-all backdrop-blur-sm">
                                <i data-lucide="chevron-right" class="w-6 h-6"></i>
                            </button>
                        </div>
                        
                        <!-- Thumbnails -->
                        <div id="carousel-thumbnails" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2">
                            <!-- Thumbnails will be injected here -->
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="text-center p-8 text-white/90">
        <p style="text-shadow: 1px 1px 4px rgba(0,0,0,0.7);">See you in Montgomery!</p>
    </footer>

    <!-- ✨ Gemini API Modal -->
    <div id="gemini-modal" class="gemini-modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 p-4 opacity-0 pointer-events-none">
        <!-- Frosted glass modal -->
        <div class="gemini-modal-content w-full max-w-2xl bg-white/90 backdrop-blur-md rounded-xl shadow-2xl p-6 md:p-8 transform scale-95">
            
            <!-- Modal Header -->
            <div class="flex justify-between items-center pb-4 border-b border-slate-300">
                <!-- Title color will be set by JS -->
                <h3 id="modal-title" class="text-2xl font-semibold text-primary">AI Results</h3>
                <button id="modal-close" class="text-slate-400 hover:text-slate-600 transition-colors">
                    <i data-lucide="x" class="w-8 h-8"></i>
                </button>
            </div>
            
            <!-- Modal Body -->
            <div id="modal-body" class="py-6 max-h-[60vh] overflow-y-auto">
                <!-- ✨ New Interactive Prompt Area -->
                <div id="modal-prompt-area" class="hidden space-y-3 mb-4">
                    <label for="modal-prompt-input" class="block text-lg font-semibold text-slate-800">Ask a specific question:</label>
                    <textarea id="modal-prompt-input" rows="3" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none" placeholder="e.g., How should I play the 18th hole?"></textarea>
                    <!-- Submit button color will be set by JS -->
                    <button id="modal-prompt-submit" class="inline-flex items-center bg-primary text-white font-bold py-2 px-6 rounded-lg shadow-sm hover:bg-primary-dark transition-all">
                        Get Caddy Tip
                    </button>
                </div>

                <!-- Loader -->
                <div id="modal-loader" class="flex justify-center items-center py-10">
                    <div class="loader"></div>
                </div>
                <!-- Content -->
                <div id="modal-result-content" class="text-slate-700 text-lg space-y-4 hidden">
                    <!-- AI text will be injected here -->
                </div>
                <!-- Sources -->
                <div id="modal-sources" class="mt-6 hidden">
                    <h4 class="font-semibold text-slate-800">Sources:</h4>
                    <ul id="sources-list" class="list-disc list-inside text-sm text-blue-600 space-y-1">
                        <!-- Sources will be injected here -->
                    </ul>
                </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="flex justify-end pt-4 border-t border-slate-300">
                <button id="modal-close-footer" class="bg-slate-300 text-slate-800 font-bold py-2 px-6 rounded-lg hover:bg-slate-400 transition-all">
                    Close
                </button>
            </div>
        </div>
    </div>
    
    <!-- This script finds all `data-lucide` icons and renders them -->
    <script>
      lucide.createIcons();
    </script>

    <!-- ✨ Gemini API Integration Script -->
    <script type="module">
        
        // --- Wrap all script logic in DOMContentLoaded listener ---
        document.addEventListener('DOMContentLoaded', (event) => {

            // Set default theme on load
            document.body.dataset.theme = 'blue'; // For modal
            
            // --- Modal Elements ---
            const modal = document.getElementById('gemini-modal');
            const modalContent = document.getElementById('gemini-modal-content'); 
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            const modalLoader = document.getElementById('modal-loader');
            const modalResultContent = document.getElementById('modal-result-content');
            const modalSources = document.getElementById('modal-sources');
            const sourcesList = document.getElementById('sources-list');
            const closeButtons = [document.getElementById('modal-close'), document.getElementById('modal-close-footer')];
            
            // --- Button Elements ---
            const packingListButton = document.getElementById('generate-packing-list');
            const dinnerButton = document.getElementById('generate-dinner-ideas');
            const legislatorCaddyButton = document.getElementById('caddy-legislator');
            const senatorCaddyButton = document.getElementById('caddy-senator');
            
            // --- "Ask" Button Elements ---
            const caddyAskLegislatorButton = document.getElementById('caddy-ask-legislator');
            const caddyAskSenatorButton = document.getElementById('caddy-ask-senator');
            
            // --- Modal Prompt Elements ---
            const modalPromptArea = document.getElementById('modal-prompt-area');
            const modalPromptInput = document.getElementById('modal-prompt-input');
            const modalPromptSubmit = document.getElementById('modal-prompt-submit');

            // --- ✨ New AI Concierge Elements ---
            const chatMessages = document.getElementById('chat-messages');
            const chatInput = document.getElementById('chat-input');
            const chatSubmit = document.getElementById('chat-submit');
            
            // --- ✨ New Gallery Elements ---
            // ✨ Renamed variable to avoid potential reference error
            const galleryEmptyState = document.getElementById('gallery-placeholder');
            const carouselContainer = document.getElementById('carousel-container');
            const carouselImage = document.getElementById('carousel-image');
            const carouselPrev = document.getElementById('carousel-prev');
            const carouselNext = document.getElementById('carousel-next');
            const carouselThumbnails = document.getElementById('carousel-thumbnails');


            // --- ✨ Updated Tab Logic ---
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanels = document.querySelectorAll('.tab-panel');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;
                    const theme = button.dataset.theme;

                    // Set body theme for modal
                    document.body.dataset.theme = theme; 

                    // Update Tab Buttons
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active-tab-blue', 'active-tab-red', 'active-tab-green', 'active-tab-gold', 'active-tab-navy');
                        // Set all to "inactive" style
                        btn.classList.add('text-slate-700', 'hover:bg-slate-200');
                    });
                    button.classList.add(`active-tab-${theme}`);
                    button.classList.remove('text-slate-700', 'hover:bg-slate-200');
                    
                    // Update Tab Panels
                    tabPanels.forEach(panel => {
                        if (panel.id === targetTab) {
                            panel.classList.add('active');
                        } else {
                            panel.classList.remove('active');
                        }
                    });

                    // ✨ Update timeline color if itinerary is active
                    if (targetTab === 'itinerary') {
                        document.documentElement.style.setProperty('--tab-color', '#16a34a'); // Green
                    }
                });
            });
            // --- End of Tab Logic ---


            // --- DEBUGGING: Log elements *inside* the listener ---
            console.log("Finding elements:");
            console.log("modal:", modal);
            console.log("modalResultContent:", modalResultContent);
            console.log("packingListButton:", packingListButton);
            console.log("dinnerButton:", dinnerButton);
            console.log("legislatorCaddyButton:", legislatorCaddyButton);
            console.log("senatorCaddyButton:", senatorCaddyButton);
            console.log("caddyAskLegislatorButton:", caddyAskLegislatorButton);
            console.log("caddyAskSenatorButton:", caddyAskSenatorButton);
            console.log("chatMessages:", chatMessages);
            console.log("chatInput:", chatInput);
            console.log("chatSubmit:", chatSubmit);
            console.log("carouselImage:", carouselImage);


            // --- Modal Functions ---
            function showModal(title) {
                if (!modal || !modalTitle || !modalLoader || !modalResultContent || !modalSources) {
                    console.error("showModal: One or more modal elements are null!");
                    return;
                }
                
                console.log("Showing modal with title:", title);

                // --- ✨ Themed Modal ---
                const theme = document.body.dataset.theme || 'blue';
                let themeColor = 'text-primary';
                let themeBg = 'bg-primary';
                let themeBgHover = 'hover:bg-primary-dark';
                let themeRing = 'focus:ring-primary';
                let loaderColor = '#0284c7'; // Default blue

                if (theme === 'red') {
                    themeColor = 'text-primary-red-DEFAULT';
                    themeBg = 'bg-primary-red-DEFAULT';
                    themeBgHover = 'hover:bg-primary-red-dark';
                    themeRing = 'focus:ring-primary-red-DEFAULT';
                    loaderColor = '#dc2626';
                } else if (theme === 'green') {
                    themeColor = 'text-primary-green-DEFAULT';
                    themeBg = 'bg-primary-green-DEFAULT';
                    themeBgHover = 'hover:bg-primary-green-dark';
                    themeRing = 'focus:ring-primary-green-DEFAULT';
                    loaderColor = '#16a34a';
                } else if (theme === 'gold') {
                    themeColor = 'text-primary-gold-DEFAULT';
                    themeBg = 'bg-primary-gold-DEFAULT';
                    themeBgHover = 'hover:bg-primary-gold-dark';
                    themeRing = 'focus:ring-primary-gold-DEFAULT';
                    loaderColor = '#d97706';
                } else if (theme === 'navy') {
                    themeColor = 'text-primary-navy-DEFAULT';
                    themeBg = 'bg-primary-navy-DEFAULT';
                    themeBgHover = 'hover:bg-primary-navy-dark';
                    themeRing = 'focus:ring-primary-navy-DEFAULT';
                    loaderColor = '#172554';
                }
                
                // Apply theme colors
                modalTitle.className = `text-2xl font-semibold ${themeColor}`;
                modalLoader.firstElementChild.style.borderTopColor = loaderColor;
                
                // Clear and re-apply classes for submit button
                modalPromptSubmit.className = `inline-flex items-center text-white font-bold py-2 px-6 rounded-lg shadow-sm transition-all ${themeBg} ${themeBgHover}`;
                // Clear and re-apply classes for input
                modalPromptInput.className = `w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 ${themeRing}`;


                modalTitle.textContent = title;
                
                // Reset modal state
                modalLoader.classList.remove('hidden');
                modalResultContent.classList.add('hidden');
                modalResultContent.innerHTML = '';
                modalSources.classList.add('hidden');
                sourcesList.innerHTML = '';
                
                modalPromptArea.classList.add('hidden'); 
                modalPromptInput.classList.remove('border-red-500'); 
                modalPromptInput.placeholder = "e.g., How should I play the 18th hole?";
                
                // Show modal
                modal.classList.remove('opacity-0', 'pointer-events-none');
                modal.firstElementChild.classList.remove('scale-95');
            }

            function closeTheModal() {
                if (!modal) {
                    console.error("hideModal: modal element is null!");
                    return;
                }
                console.log("Closing modal.");
                modal.classList.add('opacity-0', 'pointer-events-none');
                modal.firstElementChild.classList.add('scale-95');
            }

            function showModalContent(text, sources = []) {
                if (!modalLoader || !modalResultContent) {
                    console.error("showModalContent: loader or result content is null!");
                    return;
                }
                modalLoader.classList.add('hidden');
                
                let formattedText = text
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/(?<!\w)\*(.*?)\*(?!\w)/g, '<strong>$1</strong>')
                    .replace(/\n/g, '<br>')
                    .replace(/(<br>|^)(\s*)(\* | - )/g, '$1$2<span class="font-bold text-primary-dark mr-2">•</span>');
                
                modalResultContent.innerHTML = formattedText;
                modalResultContent.classList.remove('hidden');

                if (sources && sources.length > 0) {
                    console.log("Showing sources:", sources);
                    sourcesList.innerHTML = sources.map(source => 
                        `<li><a href="${source.uri}" target="_blank" rel="noopener noreferrer" class="hover:underline">${source.title}</a></li>`
                    ).join('');
                    modalSources.classList.remove('hidden');
                }
            }

            function showModalError(error) {
                if (!modalLoader || !modalResultContent) {
                    console.error("showModalError: loader or result content is null!");
                    return;
                }
                modalLoader.classList.add('hidden');
                
                let errorMessage = "An unknown error occurred. Please try again.";
                if (error instanceof Error) {
                    errorMessage = error.message;
                } else if (typeof error === 'object' && error.message) {
                    errorMessage = error.message;
                } else if (typeof error === 'string') {
                    errorMessage = error;
                }
                
                modalResultContent.innerHTML = `
                    <div class="text-red-600">
                        <strong class="font-semibold">Oops! Something went wrong:</strong>
                        <p class="mt-2">${errorMessage}</p>
                        <p class="mt-4 text-sm text-slate-600">This may be due to the preview environment's network restrictions. Please try again or test on the live site.</p>
                    </div>
                `;
                modalResultContent.classList.remove('hidden');
                console.error("Error displayed to user:", errorMessage);
            }

            // --- Gemini API Call (Secure Backend Version) ---
            async function callGeminiAPI(userQuery, systemPrompt, useGrounding = false, retries = 3, delay = 1000) {
                // This URL must match the Vercel/Netlify function path
                const apiUrl = "/api/gemini"; 
                
                const payload = {
                    userQuery,
                    systemPrompt,
                    useGrounding
                };

                console.log("Sending payload to backend API:", payload);

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorBody = await response.text();
                        console.error("Backend API Error Response Status:", response.status, "Body:", errorBody);
                        if (response.status === 429 && retries > 0) {
                            console.warn(`Throttled. Retrying in ${delay}ms... (${retries} retries left)`);
                            await new Promise(resolve => setTimeout(resolve, delay));
                            return await callGeminiAPI(userQuery, systemPrompt, useGrounding, retries - 1, delay * 2);
                        }
                        throw new Error(`Backend API Error: ${response.status} ${response.statusText}. ${errorBody}`);
                    }

                    const result = await response.json();
                    console.log("Backend API Success Response:", result);

                    if (result.text) {
                        return { text: result.text, sources: result.sources || [] };
                    } else {
                        console.error("Invalid API response structure from backend:", result);
                        throw new Error("The backend returned an unexpected response.");
                    }

                } catch (error) {
                    console.error("Backend API call failed:", error);
                    throw error;
                }
            }


            // --- Button Event Listeners ---
            if (packingListButton) {
                packingListButton.addEventListener('click', async () => {
                    console.log("Packing list button clicked.");
                    showModal("✨ AI Packing List");
                    
                    const systemPrompt = "You are a helpful travel assistant. You create concise, bulleted packing lists. Do not add any introductory or concluding text. Just the list.";
                    const userQuery = "Create a packing list for a 4-day golf trip to Montgomery, Alabama in early February. Include golf gear, casual wear for evenings, and essentials. Assume 4 rounds of golf.";

                    try {
                        const { text, sources } = await callGeminiAPI(userQuery, systemPrompt, false);
                        showModalContent(text, sources);
                    } catch (error) {
                        showModalError(error);
                    }
                });
            } else {
                console.error("Packing list button not found. AI feature will not work.");
            }

            if (dinnerButton) {
                dinnerButton.addEventListener('click', async () => {
                    console.log("Dinner ideas button clicked.");
                    showModal("✨ Dinner Suggestions");
                    
                    const systemPrompt = "You are a local food critic. You give 3-5 interesting dinner recommendations based on real-time search, including the type of cuisine. Format as a bulleted list. Provide sources.";
                    const userQuery = "Find 3-5 good dinner restaurants near downtown Montgomery, Alabama. Good for a group of guys.";

                    try {
                        const { text, sources } = await callGeminiAPI(userQuery, systemPrompt, true);
                        showModalContent(text, sources);
                    } catch (error) {
                        showModalError(error);
                    }
                });
            } else {
                console.error("Dinner ideas button not found. AI feature will not work.");
            }

            if (legislatorCaddyButton) {
                legislatorCaddyButton.addEventListener('click', async () => {
                    console.log("Legislator caddy button clicked.");
                    showModal("✨ Legislator Course Caddy");
                    
                    const systemPrompt = "You are an expert golf caddy. You provide 3-5 key, actionable tips for playing a specific golf course, using real-time search. Focus on signature holes, common hazards, and green-reading advice. Format as a bulleted list.";
                    const userQuery = "Give me 3-5 expert caddy tips for playing the Legislator course at RTJ Capitol Hill in Prattville, AL. What should I look out for?";

                    try {
                        const { text, sources } = await callGeminiAPI(userQuery, systemPrompt, true);
                        showModalContent(text, sources);
                    } catch (error) {
                        showModalError(error);
                    }
                });
            } else {
                console.error("Legislator caddy button not found. AI feature will not work.");
            }

            if (senatorCaddyButton) {
                senatorCaddyButton.addEventListener('click', async () => {
                    console.log("Senator caddy button clicked.");
                    showModal("✨ Senator Course Caddy");
                    
                    const systemPrompt = "You are an expert golf caddy. You provide 3-5 key, actionable tips for playing a specific golf course, using real-time search. Focus on signature holes, common hazards, and green-reading advice. Format as a bulleted list.";
                    const userQuery = "Give me 3-5 expert caddy tips for playing the Senator course at RTJ Capitol Hill in Prattville, AL. This is a links-style course. What should I look out for?";

                    try {
                        const { text, sources } = await callGeminiAPI(userQuery, systemPrompt, true);
                        showModalContent(text, sources);
                    } catch (error) {
                        showModalError(error);
                    }
                });
            } else {
                console.error("Senator caddy button not found. AI feature will not work.");
            }

            // --- Event Listeners for "Ask Caddy" Buttons ---
            if (caddyAskLegislatorButton) {
                caddyAskLegislatorButton.addEventListener('click', () => {
                    console.log("Ask Legislator Caddy button clicked.");
                    showModal("✨ Ask Legislator Caddy");
                    
                    modalPromptArea.classList.remove('hidden');
                    modalLoader.classList.add('hidden');
                    modalResultContent.classList.add('hidden');
                    modalSources.classList.add('hidden');
                    modalPromptInput.value = '';

                    modalPromptSubmit.onclick = async () => {
                        const userQuery = modalPromptInput.value;
                        if (!userQuery) {
                            modalPromptInput.classList.add('border-red-500', 'placeholder-red-500');
                            modalPromptInput.placeholder = "Please ask a question first!";
                            return;
                        }
                        modalPromptInput.classList.remove('border-red-500', 'placeholder-red-500');
                        modalPromptInput.placeholder = "e.g., How should I play the 18th hole?";

                        modalPromptArea.classList.add('hidden');
                        modalLoader.classList.remove('hidden');

                        const systemPrompt = "You are an expert golf caddy. You answer specific questions about the Legislator course at RTJ Capitol Hill in Prattville, AL. Use real-time search to find info if needed. Be concise.";
                        
                        try {
                            const { text, sources } = await callGeminiAPI(userQuery, systemPrompt, true);
                            showModalContent(text, sources);
                        } catch (error) {
                            showModalError(error);
                        }
                    };
                });
            } else {
                console.error("Ask Legislator Caddy button not found.");
            }

            if (caddyAskSenatorButton) {
                caddyAskSenatorButton.addEventListener('click', () => {
                    console.log("Ask Senator Caddy button clicked.");
                    showModal("✨ Ask Senator Caddy");
                    
                    modalPromptArea.classList.remove('hidden');
                    modalLoader.classList.add('hidden');
                    modalResultContent.classList.add('hidden');
                    modalSources.classList.add('hidden');
                    modalPromptInput.value = '';

                    modalPromptSubmit.onclick = async () => {
                        const userQuery = modalPromptInput.value;
                        if (!userQuery) {
                            modalPromptInput.classList.add('border-red-500', 'placeholder-red-500');
                            modalPromptInput.placeholder = "Please ask a question first!";
                            return;
                        }
                        modalPromptInput.classList.remove('border-red-500', 'placeholder-red-500');
                        modalPromptInput.placeholder = "e.g., How should I play the 18th hole?";

                        modalPromptArea.classList.add('hidden');
                        modalLoader.classList.remove('hidden');

                        const systemPrompt = "You are an expert golf caddy. You answer specific questions about the Senator course at RTJ Capitol Hill in Prattville, AL. Use real-time search to find info if needed. Be concise.";
                        
                        try {
                            const { text, sources } = await callGeminiAPI(userQuery, systemPrompt, true);
                            showModalContent(text, sources);
                        } catch (error) {
                            showModalError(error);
                        }
                    };
                });
            } else {
                console.error("Ask Senator Caddy button not found.");
            }

            // --- Modal Close Listeners ---
            closeButtons.forEach(button => {
                if (button) {
                    button.addEventListener('click', closeTheModal);
                }
            });

            if (modal) {
                modal.addEventListener('click', (event) => {
                    if (event.target === modal) {
                        closeTheModal();
                    }
                });
            }
            
            // --- ✨ Hard-coded Gallery/Carousel Logic ---
            
            // --- ✨ NEW: 16 Hard-coded gallery images ---
            let galleryImages = [
                // ✨ FIX: Changed Imgur link to be a direct image link
                { url: 'https://i.imgur.com/3pJbRjA.png', name: 'Image 1' },
                // ✨ New user images
                { url: 'https://i.imgur.com/8XhsECr.png', name: 'Image 2' },
                { url: 'https://i.imgur.com/CROP5v4.png', name: 'Image 3' },
                { url: 'https://i.imgur.com/N97xVpv.png', name: 'Image 4' },
                { url: 'https://i.imgur.com/LSlJ7UT.png', name: 'Image 5' },
                { url: 'https://i.imgur.com/OS96CaV.png', name: 'Image 6' },
                { url: 'https://i.imgur.com/q3F7818.png', name: 'Image 7' },
                { url: 'https://i.imgur.com/0JCbwo6.png', name: 'Image 8' },
                { url: 'https://i.imgur.com/FanSZyF.png', name: 'Image 9' },
                { url: 'https://i.imgur.com/UiYeNB5.png', name: 'Image 10' },
                { url: 'https://i.imgur.com/DYYWj36.png', name: 'Image 11' },
                { url: 'https://i.imgur.com/X6sKTJV.png', name: 'Image 12' },
                { url: 'https://i.imgur.com/NZh4aJc.png', name: 'Image 13' },
                { url: 'https://i.imgur.com/1ePOG0L.png', name: 'Image 14' },
                { url: 'https://i.imgur.com/TP7Y4fs.png', name: 'Image 15' },
                { url: 'https://i.imgur.com/Gj6bTAA.png', name: 'Image 16' }
            ]; 
            let currentImageIndex = 0;

            function updateGalleryView(index) {
                if (!galleryImages || galleryImages.length === 0) return;
                
                currentImageIndex = index;
                const image = galleryImages[currentImageIndex];
                
                if (carouselImage) {
                    carouselImage.src = image.url;
                    carouselImage.alt = image.name || 'Gallery Image';
                }
                
                // Update active thumbnail
                if (carouselThumbnails) {
                    carouselThumbnails.querySelectorAll('.carousel-thumbnail').forEach((thumb, i) => {
                        if (i === currentImageIndex) {
                            thumb.classList.add('ring-4', 'ring-primary-navy-DEFAULT', 'ring-offset-2');
                        } else {
                            thumb.classList.remove('ring-4', 'ring-primary-navy-DEFAULT', 'ring-offset-2');
                        }
                    });
                }
            }

            function initGallery() {
                console.log("Initializing hard-coded gallery...");

                // ✨ Using renamed variable
                if (!carouselThumbnails || !galleryEmptyState || !carouselContainer) {
                    console.error("Gallery elements not found.");
                    return;
                }

                if (galleryImages && galleryImages.length > 0) {
                    // ✨ Using renamed variable
                    galleryEmptyState.classList.add('hidden');
                    carouselContainer.classList.remove('hidden');
                    
                    carouselThumbnails.innerHTML = galleryImages.map((image, index) => `
                        <img src="${image.url}" 
                             alt="${image.name || 'thumbnail'}" 
                             class="carousel-thumbnail w-full h-auto rounded-lg aspect-video object-cover cursor-pointer transition-all duration-200 hover:opacity-80"
                             data-index="${index}">
                    `).join('');

                    carouselThumbnails.querySelectorAll('.carousel-thumbnail').forEach(thumb => {
                        thumb.addEventListener('click', () => {
                            updateGalleryView(parseInt(thumb.dataset.index));
                        });
                    });

                    updateGalleryView(0); // Start at the first image
                } else {
                    // ✨ Using renamed variable
                    galleryEmptyState.textContent = "No images in the gallery.";
                    galleryEmptyState.classList.remove('hidden');
                    carouselContainer.classList.add('hidden');
                }
            }

            initGallery(); // Call on load

            // Add Prev/Next listeners
            if (carouselPrev && carouselNext) {
                carouselPrev.addEventListener('click', () => {
                    let newIndex = (currentImageIndex - 1 + galleryImages.length) % galleryImages.length;
                    updateGalleryView(newIndex);
                });
                carouselNext.addEventListener('click', () => {
                    let newIndex = (currentImageIndex + 1) % galleryImages.length;
                    updateGalleryView(newIndex);
                });
            }
            // --- End of Gallery Logic ---


            // --- AI Concierge (ABBA) Chat Logic ---
            
            function addMessageToChat(text, role, sources = []) {
                if (!chatMessages) return;

                const messageDiv = document.createElement('div');
                let formattedText = text
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\n/g, '<br>')
                    .replace(/(<br>|^)(\s*)(\* | - )/g, '$1$2<span class="font-bold mr-2">•</span>');

                if (role === 'user') {
                    messageDiv.className = 'chat-bubble chat-bubble-user';
                    messageDiv.innerHTML = formattedText;
                } else if (role === 'ai') {
                    messageDiv.className = 'chat-bubble chat-bubble-ai';
                    messageDiv.innerHTML = formattedText;
                } else if (role === 'error') {
                    messageDiv.className = 'chat-bubble chat-bubble-error';
                    messageDiv.innerHTML = `<strong>Oops! Something went wrong:</strong><br>${formattedText}`;
                }
                
                // Add sources if they exist
                if (sources && sources.length > 0) {
                    const sourcesHtml = sources.map(source => 
                        `<li><a href="${source.uri}" target="_blank" rel="noopener noreferrer" class="hover:underline">${source.title}</a></li>`
                    ).join('');
                    messageDiv.innerHTML += `<div class="chat-sources mt-3 pt-2 border-t border-slate-300"><strong>Sources:</strong><ul class="list-disc list-inside">${sourcesHtml}</ul></div>`;
                }

                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight; // Auto-scroll to bottom
            }

            async function handleChatSubmit() {
                if (!chatInput || !chatSubmit) return;
                
                const userQuery = chatInput.value.trim();
                if (!userQuery) return;

                addMessageToChat(userQuery, 'user');
                chatInput.value = '';
                chatSubmit.disabled = true;

                // Add a temporary "typing" bubble
                const typingBubble = document.createElement('div');
                typingBubble.className = 'chat-bubble chat-bubble-ai opacity-70 italic';
                typingBubble.textContent = 'ABBA is thinking...';
                chatMessages.appendChild(typingBubble);
                chatMessages.scrollTop = chatMessages.scrollHeight;

                const systemPrompt = "You are ABBA, an expert AI concierge for a golf trip to Montgomery, Alabama. You have access to real-time search. Be friendly, knowledgeable, and concise. Your friends are on the 'OG Weekend' trip. Answer questions about Montgomery, the RTJ Capitol Hill golf courses, local attractions, food, or anything else they might need.";

                try {
                    const { text, sources } = await callGeminiAPI(userQuery, systemPrompt, true);
                    chatMessages.removeChild(typingBubble); // Remove "typing" bubble
                    addMessageToChat(text, 'ai', sources);
                } catch (error) {
                    chatMessages.removeChild(typingBubble); // Remove "typing" bubble
                    addMessageToChat(error.message, 'error');
                } finally {
                    chatSubmit.disabled = false;
                }
            }

            if (chatSubmit && chatInput) {
                chatSubmit.addEventListener('click', handleChatSubmit);
                chatInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        handleChatSubmit();
                    }
                });
            } else {
                console.error("AI Concierge chat elements not found.");
            }
        
        }); // End of DOMContentLoaded listener
    </script>
</body>
</html>

